<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Pathfinder REST Monitor</title>

    <style>
      body {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
        background: #f9fafb;
        color: #111827;
        margin: 0;
        padding: 2rem;
      }

      .card {
        max-width: 900px;
        margin: 0 auto;
        background: #ffffff;
        border-radius: 0.75rem;
        padding: 1.5rem;
        box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        border: 1px solid #e5e7eb;
      }

      h1 {
        margin: 0;
        font-size: 1.45rem;
        font-weight: 600;
      }

      button {
        padding: 0.45rem 1rem;
        border-radius: 999px;
        border: 1px solid #d1d5db;
        background: #f3f4f6;
        color: #111827;
        cursor: pointer;
        font-size: 0.9rem;
        margin-top: 1rem;
        transition: background 0.15s, border-color 0.15s;
      }

      button:hover {
        background: #e5e7eb;
        border-color: #cbd5e1;
      }

      #meta {
        font-size: 0.8rem;
        color: #6b7280;
        margin-left: 1rem;
      }

      pre {
        margin-top: 1.5rem;
        background: #f3f4f6;
        border-radius: 0.5rem;
        padding: 1rem;
        overflow: auto;
        font-size: 0.85rem;
        line-height: 1.35;
        border: 1px solid #e5e7eb;
        white-space: pre-wrap;
        word-wrap: break-word;
      }
    </style>
  </head>

  <body>
    <div class="card">
      <h1>KXJZ</h1>

      <button id="refresh">Refresh</button>
      <span id="meta"></span>

      <pre id="output">Waiting for dataâ€¦</pre>
    </div>

<script>
  async function load() {
    const output = document.getElementById("output");
    const meta = document.getElementById("meta");

    try {
      const res = await fetch("/.netlify/functions/pathfinder-hook");
      const data = await res.json();

      if (data.error) {
        meta.textContent = "";
        output.textContent = data.error;
        return;
      }

      meta.textContent = data.receivedAt
        ? "Last received: " + new Date(data.receivedAt).toLocaleString()
        : "";

      // SHOW ONLY rawBody
      output.textContent = data.rawBody || "No rawBody found.";
    } catch (err) {
      output.textContent = "Error: " + err;
    }
  }

  document.getElementById("refresh").addEventListener("click", load);

  // Auto-refresh every 10 seconds
  setInterval(load, 10000);

  // Initial load
  load();
</script>

  </body>
</html>
